<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
  <div
    class="container-fluid px-lg-5 py-2 d-flex justify-content-between align-items-center"
  >
    <a
      class="navbar-brand fw-bold text-danger d-flex align-items-center gap-2"
      href="/"
    >
      <img
        src="/images/plane.jpg"
        alt="logo"
        width="28"
        height="28"
        class="rounded-circle"
      />
      wanderlust
    </a>
    <a href="/listings" class="btn btn-light px-3">Explore</a>

    <form
      class="d-none d-md-flex mx-auto w-50"
      role="search"
      action="/listings/search"
      method="GET"
    >
      <input
        class="form-control rounded-start-pill border-end-0"
        type="search"
        name="q"
        placeholder="Search destination"
        aria-label="Search"
      />
      <button
        class="btn btn-danger rounded-end-pill border-start-0 px-4"
        type="submit"
      >
        <i class="fa fa-search me-1"></i> Search
      </button>
    </form>

    <div class="d-flex align-items-center gap-3">
      <a href="/listings/cart" class="btn btn-light px-3 position-relative">
        <i class="fa fa-shopping-cart cart-icon"></i>
        Cart
        <span
          id="cart-badge"
          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
          style="<%= cartCount > 0 ? '' : 'display:none;' %>"
        >
          <%= cartCount %>
        </span>
      </a>
      <a href="/listings/new" class="btn btn-light px-3">Add New Listings</a>

      <% if (!currentUser) { %>
      <a
        href="/login"
        class="btn text-dark fw-medium px-2"
        style="text-decoration: none"
        >Login</a
      >
      <a
        href="/signup"
        class="btn text-dark fw-medium px-2"
        style="text-decoration: none"
        >Sign Up</a
      >
      <% } else { %>
      <div class="dropdown">
        <button
          class="btn btn-outline-dark dropdown-toggle"
          type="button"
          id="navbarDropdown"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <%= currentUser.username %>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="/logout">Logout</a></li>
        </ul>
      </div>
      <% } %>
    </div>
  </div>
</nav>

<style>
  .cart-icon.spin {
    animation: spin 0.6s linear;
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  .add-to-cart-btn.spin {
    pointer-events: none;
    opacity: 0.75;
  }

  .add-to-cart-btn .fa-spinner {
    margin-left: 8px;
  }
</style>
